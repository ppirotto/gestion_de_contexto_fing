<?xml version="1.0" encoding="ISO-8859-1" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pe="http://primefaces.org/ui/extensions"
	template="/masterTemplate.xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

	<ui:define name="title">Home</ui:define>
	<ui:define name="body">
		<h1>
			<h:outputText value="Crear Itinerario" />
		</h1>

		<h:form enctype="multipart/form-data">
			<h:panelGrid columns="2">
				<p:panelGrid columns="2">

					<p:outputLabel for="selectMenu"><b>Servicio</b></p:outputLabel>
					<p:selectOneMenu id="selectMenu" autoupdate="true"
						styleClass="span4" value="#{itineraryBean.selectedService}"
						effect="fade">
						<f:selectItem itemLabel="Seleccione un servicio" itemValue="" />
						<f:selectItems value="#{itineraryBean.serviceList}" var="Service"
							itemLabel="#{Service.serviceName}/#{Service.operationName}" itemValue="#{Service}" />
					</p:selectOneMenu>

					<p:outputLabel for="selectSituation"  ><b>Situación</b> </p:outputLabel>
					<p:selectOneMenu id="selectSituation" autoupdate="true"
						styleClass="span4" value="#{itineraryBean.selectedSituation}"
						effect="fade">
						<f:selectItem itemLabel="Seleccione una situación" itemValue="" />
						<f:selectItems value="#{itineraryBean.situationList}"
							var="Situation" itemLabel="#{Situation.name}" itemValue="#{Situation}" />
					</p:selectOneMenu>

					<h:outputLabel ><b>Paso del itinerario</b></h:outputLabel>
					<p:selectOneMenu id="selectAdaptType" autoupdate="true"
						styleClass="span4" value="#{itineraryBean.adaptSelec}"
						effect="fade">
						<f:selectItem itemLabel="Seleccione adaptación a crear"
							itemValue="" />
						<f:selectItem itemLabel="Filter" itemValue="FILTER" />
						<f:selectItem itemLabel="Delay" itemValue="DELAY" />
						<f:selectItem itemLabel="Enrich" itemValue="ENRICH" />
						<f:selectItem itemLabel="Service" itemValue="SERVICE_INVOCATION" />

					</p:selectOneMenu>

					<p:outputLabel>
						<b>Prioridad</b>
					</p:outputLabel>
					<p:inputText id="prioridad" size="10"
						value="#{itineraryBean.priority}" label="Prioridad">
						<f:convertNumber integerOnly="true" type="number" />
					</p:inputText>
					
				</p:panelGrid>

				<h:panelGrid columns="2">

					<p:growl id="growl" life="2000" />
					<p:commandButton value="Agregar" id="ajax"
						update="growl adaptaciones"
						actionListener="#{itineraryBean.agregarAdaptacion}" />

				</h:panelGrid>

			</h:panelGrid>

			<h2>
				<h:outputText value="Itinerario:" />
			</h2>

			<p:panelGrid id="adaptaciones" styleClass="centerContent">
				<c:forEach items="#{itineraryBean.adaptations}" var="adap"
					varStatus="status">
					<p:row>
						<p:column>
							<h:outputText value="#{adap.id}" />
						</p:column>
						<p:column>
							<h:outputText value="#{adap.adaptationType}" />
						</p:column>

						<p:column rendered="#{adap.adaptationType != 'DELAY'}">
							<p:fileUpload value="#{adap.data}" mode="simple"
								dragDropSupport="true" />
						</p:column>
						<p:column rendered="#{adap.adaptationType == 'DELAY'}">
							<p:inputText value="#{adap.extraData}" />
						</p:column>
					</p:row>
				</c:forEach>
			</p:panelGrid>


			<p:growl id="growl2" life="2000" />
			<p:commandButton value="Crear Itinerario"
				actionListener="#{itineraryBean.crearItinerario()}" update="growl2"
				styleClass="ui-priority-primary " style="margin-top: 10px;" />

			<p:growl id="messages" showDetail="true" />
		</h:form>
	</ui:define>
	<ui:define name="menuIzq">
		<ui:include src="/menu.xhtml" />
	</ui:define>
</ui:composition>